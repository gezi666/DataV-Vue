(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19fcdc06","chunk-a774e7ac"],{"11f1":function(t,e,a){},"2c3f":function(t,e,a){"use strict";var i=a("c180"),n=a.n(i);n.a},"49cd":function(t,e,a){"use strict";var i=a("d65a"),n=a.n(i);n.a},"4bf3":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compbox",class:{compHighLight:t.isHighlight},style:t.boxStyle,attrs:{id:t.contentId}},[a(t.compConf.componentName,{ref:"contentComp",tag:"component",attrs:{compConf:t.compConf,mainId:t.compConf.compId,id:t.compConf.compId},on:{compState:t.compStateChanged}})],1)},n=[],o=(a("99af"),a("d81d"),a("b64b"),a("5530")),s=a("2f62"),c=!1,r={name:"previewCompItem",data:function(){return{myChart:null,isCtrl:!1,translateX:0,translateY:0,scaleW:1,scaleH:1,isReload:!1,linkageData:{},compState:null}},components:{},mixins:[],props:["compConf"],computed:Object(o["a"])(Object(o["a"])({},Object(s["c"])({activeComp:"getFirstActiveComp"})),{},{id:function(){return this.compConf.compId},contentId:function(){return this.id+"-preview-box"},boxStyle:function(){var t=this.compConf,e={};return t?(t.box.top&&(e.top=t.box.top+"px"),t.box.left&&(e.left=t.box.left+"px"),t.box.height&&(e.height=t.box.height+"px"),t.box.width&&(e.width=t.box.width+"px"),e.zIndex=t.compIndex,e.transform="translate(".concat(this.translateX,"px, ").concat(this.translateY,"px) scale(").concat(this.scaleW,", ").concat(this.scaleH,") rotate(").concat(t.box.rotate,"deg)"),e):e},isHighlight:function(){var t=this.compConf;return t.isHighlight&&!this.$store.getters.getPreviewState}}),created:function(){this.scaleW=1},updated:function(){this.isReload&&(this.$refs.contentComp.resize&&this.$refs.contentComp.resize(),this.isReload=!1)},methods:Object(o["a"])(Object(o["a"])({},Object(s["b"])(["switchComListDisplayState","moveTop","moveUp","moveDown","moveBottom","delComs","selectOnlyOne","selectComs","highLightCom","cancelHighLightCom"])),{},{handleOver:function(t){t.index;this.$store.commit("changeHighlight",{compId:this.id,value:!0})},handleOut:function(){this.$store.commit("changeHighlight",{compId:this.id,value:!1})},handleFocus:function(t){t.index;this.selectOnlyOne(this.id),this.$store.commit("setScreenGridShow",!0)},handleBlur:function(t){var e=t.left,a=t.top,i=t.width,n=t.height,o={compId:this.id,left:e,top:a,width:i,height:n};this.$store.commit("updateCompStyle",o),this.isReload=!0,this.$store.commit("setScreenGridShow",!1)},updateComp:function(t){t&&t.compId==this.compConf.compId&&(t.translateX&&(this.translateX=t.translateX),t.translateY&&(this.translateY=t.translateY),t.scaleH&&(this.scaleH=t.scaleH),t.scaleW&&(this.scaleW=t.scaleW))},changeScaleStyle:function(){var t=this;this.activeComp.property&&Object.keys(this.activeComp.property).map((function(e,a){t.activeComp.property[e].map((function(a,i){var n=["style"],o=0;"base"==e?(n.push(a),o=Math.ceil(t.scaleW*t.activeComp.style[a])):(n.push(e,a),o=Math.ceil(t.scaleW*t.activeComp.style[e][a])),t.$store.commit("modifyValueBySelected",{attrs:n,value:o})}))}))},clickComp:function(){this.$store.getters.getPreviewState||(this.isCtrl||this.$store.commit("cleanAllActive"),this.$store.commit("changeActive",{compId:this.id,value:!0}),this.isCtrl=!1)},multiselect:function(){this.$store.getters.getPreviewState||(this.isCtrl=!0)},enter:function(){this.$store.getters.getPreviewState||this.$store.commit("changeHighlight",{compId:this.id,value:!0})},leave:function(){this.$store.getters.getPreviewState||this.$store.commit("changeHighlight",{compId:this.id,value:!1})},reloadComp:function(t){t&&t.compId==this.compConf.compId&&(this.translateX=0,this.translateY=0,this.scaleW=1,this.scaleH=1,this.isReload=!0)},compStateChanged:function(t){c&&console.log("AbstractComp","[",this.id,"]","state change from:",this.compState," to ",t),this.compState=t},updateCompData:function(t){var e=this.$refs.contentComp;e.updateCompData||console.error("the component [",this.id,"] is not exist."),e.updateCompData(t)}})},l=r,d=(a("9e72"),a("2877")),p=Object(d["a"])(l,i,n,!1,null,"7bfa353d",null);e["a"]=p.exports},"5c07":function(t,e,a){"use strict";a("d3b7"),a("96cf");var i=a("1da1"),n=a("f899"),o={loadPreviewData:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){n["a"].get(t).then((function(t){e(t)}))["catch"]((function(t){a(t)}))})));case 1:case"end":return e.stop()}}),e)})))()}};e["a"]=o},6446:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"project-preview"},[t.pageId?a("preview",{attrs:{isProjectPreview:!0,pageId:t.pageId,pageParam:t.pageParam}}):t._e(),t.firstLoad||t.pageId?t._e():a("page404"),a(t.nav.typeId,{ref:"navComp",tag:"component",attrs:{nav:t.nav,menuItemId:t.menuItemId}})],1)},n=[],o=(a("b64b"),a("5530")),s=a("24d2"),c=a("0e0b"),r=a("2f62"),l=a("71f9"),d=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},p=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page404"},[a("div",{staticClass:"container"},[a("div",{staticClass:"figure"},[a("div",{staticClass:"mj"},[a("div",{staticClass:"head"},[a("div",{staticClass:"nose"}),a("div",{staticClass:"hair"},[a("div",{staticClass:"ponytail"}),a("div",{staticClass:"frontpony"})])]),a("div",{staticClass:"body"},[a("div",{staticClass:"jacket"},[a("div",{staticClass:"hand"})])]),a("div",{staticClass:"leg"},[a("div",{staticClass:"foot"})]),a("div",{staticClass:"leg lft"},[a("div",{staticClass:"foot"})])]),a("div",{staticClass:"error-no"},[a("span",[t._v("4")]),a("div",{staticClass:"moon"}),a("span",[t._v("4")])])])])])}],m=(a("2ef0"),{name:"page404",props:{},data:function(){return{}},computed:Object(o["a"])({},Object(r["d"])([])),created:function(){},mounted:function(){var t=this;window.onresize=function(){t.initPageSize()}},beforeDestroy:function(){},methods:Object(o["a"])({},Object(r["b"])(["initPageSize"]))}),h=m,u=(a("49cd"),a("2877")),f=Object(u["a"])(h,d,p,!1,null,"262b4193",null),g=f.exports,v={name:"projectPreview",components:{preview:l["default"],page404:g},provide:function(){return{projectPreview:this}},data:function(){return{nav:{},pageId:"",pageParam:{},menuItemId:"",firstLoad:!0}},computed:Object(o["a"])({},Object(r["d"])(["project"])),watch:{},created:function(){var t=this.$route.query.projectId;this.getProjectNav(t)},mounted:function(){},beforeDestroy:function(){},methods:{getProjectNav:function(t){var e=this;s["a"].getNavByProjectId(t).then((function(t){if(console.log("getProjectNav -> res",t),200==t.code){var a=t.data;if(a&&a.constructor==Object&&Object.keys(a).length){e.nav=c["a"].deepCopy(a),e.menuItemId=e.nav.navigationItemId;var i=e.nav.menuList||[];e.getPageId(i)}}}))},getPageId:function(t){for(var e=0;e<t.length;e++){var a=t[e];if(a.id==this.menuItemId)return this.pageId=a.pageId,this.pageParam=a.pageParam,this.firstLoad=!1,!0;if(a.children.length){var i=a.children,n=this.getPageId(i);if(n)return!0}}return!1},changeMenuItem:function(t,e){this.pageId=t,this.pageParam=e}}},C=v,b=(a("2c3f"),Object(u["a"])(C,i,n,!1,null,"459f1ae8",null));e["default"]=b.exports},"71f9":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page page-preview"},[a("div",{staticClass:"preview-comp-item-container"},t._l(t.compMap,(function(e,i){return-1===["layerChildren","themeLayer"].indexOf(e.compType)?a("preview-comp-item",{key:i,attrs:{compConf:e}}):t._e()})),1)])},n=[],o=(a("a4d3"),a("e01a"),a("99af"),a("277d"),a("b0c0"),a("5530")),s=a("4bf3"),c=a("2f62"),r=a("0e0b"),l=a("5c07"),d={name:"preview",components:{previewCompItem:s["a"]},props:{isProjectPreview:{type:Boolean,default:!1},pageId:{type:String,default:""},pageParam:{type:Object}},data:function(){return{flag:!0}},computed:Object(o["a"])(Object(o["a"])({},Object(c["d"])(["preview"])),{},{compMap:function(){return this.preview.components.value},pageIdAndParams:function(){var t=this.pageId,e=this.pageParam;return{pageId:t,pageParam:e}}}),watch:{pageIdAndParams:{handler:function(t,e){this.init()},deep:!0}},created:function(){this.init()},mounted:function(){var t=this;window.onresize=function(){t.flag&&t.initPageSize()}},beforeDestroy:function(){document.querySelector("#app").style.background="none",this.$store.commit("clearData"),this.$evtBus.clearCycle()},methods:Object(o["a"])(Object(o["a"])({},Object(c["b"])(["initPageSize"])),{},{init:function(){var t=this,e="";if(this.isProjectPreview){if(e=this.pageId,!e)return void this.$message.error("此菜单项没有配置页面，无法跳转！")}else e=r["a"].getQueryString("pageId");if(this.$store.commit("setStatus",!0),r["a"].dataSaveMode()==r["a"].serverMode||e){var a=r["a"].getQueryString("state");l["a"].loadPreviewData("".concat(r["a"].appServerURL(),"open/").concat(2==a?"publish/":"").concat(e)).then((function(e){if(0==e.state)return t.$alert(e.message,"提示",{confirmButtonText:"确定",type:"error",callback:function(t){window.location.href="/"}}),!1;window.document.title=e.data.description||"可视化预览页面";var a=JSON.parse(e.data.conf);console.log("created -> conf",a),window.debug=a.isShowLog;var i=a.globalParams;i&&Array.isArray(i)&&i.length&&(t.flag=t.analysisParams(i)),t.flag&&(t.$store.dispatch("loadData",a).then((function(e){t.initPageSize()})),t.$dm.loadCompData(t.$store.state.preview.components.value))}))}else console.log("本地模式且没有pageId"),window.debug=!!localStorage.getItem("isShowLog"),this.$store.dispatch("loadData",null).then((function(e){t.initPageSize()})),this.$dm.loadCompData(this.$store.state.preview.components.value)},analysisParams:function(t){var e;e=this.isProjectPreview?this.pageParam:r["a"].getAllUrlParams();for(var a={},i=0;i<t.length;i++){var n=t[i],o=n.name,s=e[o];if(n.required){if(!s)return this.$alert("参数错误，缺少必传参数：".concat(o),"提示",{confirmButtonText:"确定",type:"error",callback:function(t){}}),!1;a[o]=s}else a[o]=s||n.value}return console.log("analysisParams -> resultParams",a),this.$store.commit("changePreviewParams",a),!0}})},p=d,m=a("2877"),h=Object(m["a"])(p,i,n,!1,null,null,null);e["default"]=h.exports},"9e72":function(t,e,a){"use strict";var i=a("11f1"),n=a.n(i);n.a},c180:function(t,e,a){},d65a:function(t,e,a){}}]);