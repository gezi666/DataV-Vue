(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a774e7ac"],{"11f1":function(t,e,a){},"4bf3":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compbox",class:{compHighLight:t.isHighlight},style:t.boxStyle,attrs:{id:t.contentId}},[a(t.compConf.componentName,{ref:"contentComp",tag:"component",attrs:{compConf:t.compConf,mainId:t.compConf.compId,id:t.compConf.compId},on:{compState:t.compStateChanged}})],1)},o=[],n=(a("99af"),a("d81d"),a("b64b"),a("5530")),s=a("2f62"),c=!1,r={name:"previewCompItem",data:function(){return{myChart:null,isCtrl:!1,translateX:0,translateY:0,scaleW:1,scaleH:1,isReload:!1,linkageData:{},compState:null}},components:{},mixins:[],props:["compConf"],computed:Object(n["a"])(Object(n["a"])({},Object(s["c"])({activeComp:"getFirstActiveComp"})),{},{id:function(){return this.compConf.compId},contentId:function(){return this.id+"-preview-box"},boxStyle:function(){var t=this.compConf,e={};return t?(t.box.top&&(e.top=t.box.top+"px"),t.box.left&&(e.left=t.box.left+"px"),t.box.height&&(e.height=t.box.height+"px"),t.box.width&&(e.width=t.box.width+"px"),e.zIndex=t.compIndex,e.transform="translate(".concat(this.translateX,"px, ").concat(this.translateY,"px) scale(").concat(this.scaleW,", ").concat(this.scaleH,") rotate(").concat(t.box.rotate,"deg)"),e):e},isHighlight:function(){var t=this.compConf;return t.isHighlight&&!this.$store.getters.getPreviewState}}),created:function(){this.scaleW=1},updated:function(){this.isReload&&(this.$refs.contentComp.resize&&this.$refs.contentComp.resize(),this.isReload=!1)},methods:Object(n["a"])(Object(n["a"])({},Object(s["b"])(["switchComListDisplayState","moveTop","moveUp","moveDown","moveBottom","delComs","selectOnlyOne","selectComs","highLightCom","cancelHighLightCom"])),{},{handleOver:function(t){t.index;this.$store.commit("changeHighlight",{compId:this.id,value:!0})},handleOut:function(){this.$store.commit("changeHighlight",{compId:this.id,value:!1})},handleFocus:function(t){t.index;this.selectOnlyOne(this.id),this.$store.commit("setScreenGridShow",!0)},handleBlur:function(t){var e=t.left,a=t.top,i=t.width,o=t.height,n={compId:this.id,left:e,top:a,width:i,height:o};this.$store.commit("updateCompStyle",n),this.isReload=!0,this.$store.commit("setScreenGridShow",!1)},updateComp:function(t){t&&t.compId==this.compConf.compId&&(t.translateX&&(this.translateX=t.translateX),t.translateY&&(this.translateY=t.translateY),t.scaleH&&(this.scaleH=t.scaleH),t.scaleW&&(this.scaleW=t.scaleW))},changeScaleStyle:function(){var t=this;this.activeComp.property&&Object.keys(this.activeComp.property).map((function(e,a){t.activeComp.property[e].map((function(a,i){var o=["style"],n=0;"base"==e?(o.push(a),n=Math.ceil(t.scaleW*t.activeComp.style[a])):(o.push(e,a),n=Math.ceil(t.scaleW*t.activeComp.style[e][a])),t.$store.commit("modifyValueBySelected",{attrs:o,value:n})}))}))},clickComp:function(){this.$store.getters.getPreviewState||(this.isCtrl||this.$store.commit("cleanAllActive"),this.$store.commit("changeActive",{compId:this.id,value:!0}),this.isCtrl=!1)},multiselect:function(){this.$store.getters.getPreviewState||(this.isCtrl=!0)},enter:function(){this.$store.getters.getPreviewState||this.$store.commit("changeHighlight",{compId:this.id,value:!0})},leave:function(){this.$store.getters.getPreviewState||this.$store.commit("changeHighlight",{compId:this.id,value:!1})},reloadComp:function(t){t&&t.compId==this.compConf.compId&&(this.translateX=0,this.translateY=0,this.scaleW=1,this.scaleH=1,this.isReload=!0)},compStateChanged:function(t){c&&console.log("AbstractComp","[",this.id,"]","state change from:",this.compState," to ",t),this.compState=t},updateCompData:function(t){var e=this.$refs.contentComp;e.updateCompData||console.error("the component [",this.id,"] is not exist."),e.updateCompData(t)}})},l=r,h=(a("9e72"),a("2877")),p=Object(h["a"])(l,i,o,!1,null,"7bfa353d",null);e["a"]=p.exports},"5c07":function(t,e,a){"use strict";a("d3b7"),a("96cf");var i=a("1da1"),o=a("f899"),n={loadPreviewData:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){o["a"].get(t).then((function(t){e(t)}))["catch"]((function(t){a(t)}))})));case 1:case"end":return e.stop()}}),e)})))()}};e["a"]=n},"71f9":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page page-preview"},[a("div",{staticClass:"preview-comp-item-container"},t._l(t.compMap,(function(e,i){return-1===["layerChildren","themeLayer"].indexOf(e.compType)?a("preview-comp-item",{key:i,attrs:{compConf:e}}):t._e()})),1)])},o=[],n=(a("a4d3"),a("e01a"),a("99af"),a("277d"),a("b0c0"),a("5530")),s=a("4bf3"),c=a("2f62"),r=a("0e0b"),l=a("5c07"),h={name:"preview",components:{previewCompItem:s["a"]},props:{isProjectPreview:{type:Boolean,default:!1},pageId:{type:String,default:""},pageParam:{type:Object}},data:function(){return{flag:!0}},computed:Object(n["a"])(Object(n["a"])({},Object(c["d"])(["preview"])),{},{compMap:function(){return this.preview.components.value},pageIdAndParams:function(){var t=this.pageId,e=this.pageParam;return{pageId:t,pageParam:e}}}),watch:{pageIdAndParams:{handler:function(t,e){this.init()},deep:!0}},created:function(){this.init()},mounted:function(){var t=this;window.onresize=function(){t.flag&&t.initPageSize()}},beforeDestroy:function(){document.querySelector("#app").style.background="none",this.$store.commit("clearData"),this.$evtBus.clearCycle()},methods:Object(n["a"])(Object(n["a"])({},Object(c["b"])(["initPageSize"])),{},{init:function(){var t=this,e="";if(this.isProjectPreview){if(e=this.pageId,!e)return void this.$message.error("此菜单项没有配置页面，无法跳转！")}else e=r["a"].getQueryString("pageId");if(this.$store.commit("setStatus",!0),r["a"].dataSaveMode()==r["a"].serverMode||e){var a=r["a"].getQueryString("state");l["a"].loadPreviewData("".concat(r["a"].appServerURL(),"open/").concat(2==a?"publish/":"").concat(e)).then((function(e){if(0==e.state)return t.$alert(e.message,"提示",{confirmButtonText:"确定",type:"error",callback:function(t){window.location.href="/"}}),!1;window.document.title=e.data.description||"可视化预览页面";var a=JSON.parse(e.data.conf);console.log("created -> conf",a),window.debug=a.isShowLog;var i=a.globalParams;i&&Array.isArray(i)&&i.length&&(t.flag=t.analysisParams(i)),t.flag&&(t.$store.dispatch("loadData",a).then((function(e){t.initPageSize()})),t.$dm.loadCompData(t.$store.state.preview.components.value))}))}else console.log("本地模式且没有pageId"),window.debug=!!localStorage.getItem("isShowLog"),this.$store.dispatch("loadData",null).then((function(e){t.initPageSize()})),this.$dm.loadCompData(this.$store.state.preview.components.value)},analysisParams:function(t){var e;e=this.isProjectPreview?this.pageParam:r["a"].getAllUrlParams();for(var a={},i=0;i<t.length;i++){var o=t[i],n=o.name,s=e[n];if(o.required){if(!s)return this.$alert("参数错误，缺少必传参数：".concat(n),"提示",{confirmButtonText:"确定",type:"error",callback:function(t){}}),!1;a[n]=s}else a[n]=s||o.value}return console.log("analysisParams -> resultParams",a),this.$store.commit("changePreviewParams",a),!0}})},p=h,m=a("2877"),d=Object(m["a"])(p,i,o,!1,null,null,null);e["default"]=d.exports},"9e72":function(t,e,a){"use strict";var i=a("11f1"),o=a.n(i);o.a}}]);