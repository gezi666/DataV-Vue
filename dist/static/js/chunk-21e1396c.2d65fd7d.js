(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21e1396c"],{"0a8a":function(t,e,n){"use strict";n("4160"),n("277d"),n("a434"),n("b0c0"),n("a9e3"),n("ac1f"),n("1276"),n("159b"),n("4795");var a=n("ade3"),i=n("53ca"),o=n("5530"),r=n("7031"),c=n("0e0b"),s=n("2f62"),u=n("4d70");e["a"]={name:"AbstractIndicatorComp",mixins:[r["a"]],data:function(){return{activeIndex:-1,indicatorPosition:"none",pageSizeTS:10,arrowTS:"hover",options:[]}},computed:Object(o["a"])(Object(o["a"])({},Object(s["c"])({activeComp:"getFirstActiveComp"})),{},{compStyle:function(){return this.compConf.style},boxStyle:function(){var t=this.compStyle.boxBorder;return{width:this.box.width+"px",height:this.box.height+"px",backgroundColor:this.compStyle.backgroundColor,padding:this.compStyle.padding+"px",borderWidth:t.borderWidth+"px",borderStyle:t.borderType,borderColor:t.borderColor,borderRadius:t.borderRadius+"px"}},boxHeight:function(){return this.box.height+"px"},fieldMap:function(){return this.compStyle.fieldMap},isPaging:function(){return this.compStyle.isPaging},pageSize:function(){return this.compStyle.pageSize},direction:function(){return this.compStyle.direction},arrow:function(){return this.compStyle.arrow},loop:function(){return this.compStyle.loop},autoplay:function(){return this.compStyle.autoplay},interval:function(){return this.compStyle.interval},linkComps:function(){return this.compStyle.linkComps},convertData:function(){var t=c["a"].deepCopy(this.options),e=t.length,n=this.pageSize||Number.POSITIVE_INFINITY;if(e&&n){var a=Math.ceil(e/n);n==Number.POSITIVE_INFINITY&&(a=1,n=e);for(var i=[],o=0;o<a;o++){var r=t.splice(0,n);i.push(r)}return i}return[]}}),watch:{isPaging:function(t,e){this.isPagingHandle()},interval:function(t,e){this.autoplay&&(Object(u["d"])("autoplay",!1),setTimeout((function(){Object(u["d"])("autoplay",!0)})))},activeComp:{handler:function(t,e){t&&this.compId==t.compId&&this.isPagingInt()},immediate:!0},linkComps:{handler:function(t,e){this.loadLinkage(this.activeIndex)},deep:!0}},mounted:function(){this.pageSize||this.$store.commit("modifyValueByCompId",{attrs:[this.compId,"style","pageSize"],value:Number.POSITIVE_INFINITY}),this.isPaging?this.indicatorPosition="inside":this.indicatorPosition="none"},methods:{updateChartData:function(){this.options=_.cloneDeep(this.convertChartData(this.compData)),this.linkageConfChanged()},convertChartData:function(t){return"static"===this.compConf.data.datasource.type?t:t[0]||[]},isPagingInt:function(){this.isPaging?(Object(u["d"])("pageSizeDisabled",!1),Object(u["d"])("arrowDisabled",!1),this.indicatorPosition="inside"):(this.pageSize!=Number.POSITIVE_INFINITY&&(this.pageSizeTS=this.pageSize,this.arrowTS=this.arrow),Object(u["d"])("pageSize",Number.POSITIVE_INFINITY),Object(u["d"])("arrow","never"),Object(u["d"])("pageSizeDisabled",!0),Object(u["d"])("arrowDisabled",!0),this.indicatorPosition="none")},isPagingHandle:function(){this.isPaging&&(Object(u["d"])("pageSize",this.pageSizeTS),Object(u["d"])("arrow",this.arrowTS)),this.isPagingInt()},getMyIndex:function(t,e){return this.pageSize==Number.POSITIVE_INFINITY?e:t*this.pageSize+e},itemStyle:function(t,e){var n=this.getMyIndex(t,e),a=this.activeIndex===n?"active":"default";this.compStyle.activeFlag||(a="default");var i=this.compStyle["".concat(a,"Border")],o={marginBottom:this.compStyle["defaultMargin"]+"px",width:this.compStyle["".concat(a,"Width")]+"px",height:this.compStyle["".concat(a,"Height")]+"px",backgroundColor:this.compStyle["".concat(a,"BackgroundColor")],backgroundImage:"url("+this.compStyle["".concat(a,"BackgroundImage")]+")",borderWidth:i.borderWidth+"px",borderStyle:i.borderType,borderColor:i.borderColor,borderRadius:i.borderRadius+"px",cursor:this.compStyle.activeFlag?"pointer":"default"};return o},elementStyle:function(t,e,n){var a=this.getMyIndex(e,n),i=this.activeIndex===a?"active":"default";this.compStyle.activeFlag||(i="default");var o=this.compStyle[i+t],r={width:o.width?o.width+"px":"",fontFamily:o.fontFamily,fontWeight:o.fontWeight,fontSize:o.fontSize+"px",color:o.fontColor};return r},iconStyle:function(t,e){var n=this.getMyIndex(t,e),a=this.activeIndex===n?"active":"default",i=this.compStyle[a+"Icon"],o=i.flag;this.compStyle.activeFlag&&("active"!=a||o)||(i=this.compStyle["defaultIcon"]);var r=i,c=r.width,s=r.height,u={width:c?c+"px":"",height:s?s+"px":""};return u},iconValue:function(t,e,n){var a=this.getMyIndex(e,n),i=this.activeIndex===a?"active":"default",o=this.compStyle[i+"Icon"],r=o.flag;this.compStyle.activeFlag&&("active"!=i||r)||(o=this.compStyle["defaultIcon"]);var c=o.iconData,s=t[this.fieldMap.id],u=c[s];return u},indicatorClick:function(t,e){if(this.compStyle.activeFlag){var n=this.getMyIndex(t,e);this.activeIndex!=n&&(this.loadLinkage(n),this.activeIndex=n)}},loadLinkage:function(t){var e=this;if(this.compConf.linkage&&this.compConf.linkage.linkEvents)for(var n=this.compConf.linkage.linkEvents,a=0;a<n.length;a++){var o=n[a];if("click"===o.evtType&&o.explosive){var r=function(){var n=e.options[t]||{},a=n[e.fieldMap.id];if(!a)return{v:void 0};var i={data:n},r=e.linkComps;if(o.ctrlShow&&Array.isArray(r)&&r.length){var c={};r.forEach((function(t){t.child.forEach((function(t){c[t]=!1}))})),r.forEach((function(t){t.id==a&&t.child.forEach((function(t){c[t]=!0}))})),i.switchVisible=c}e.$evtBus.emit(o.evtName,i)}();if("object"===Object(i["a"])(r))return r.v}}},_clickByLinkAge:function(t){var e=this;this.$evtBus.on(t,(function(t){e._toggleCompShow(t.ctrlShow,t.switchVisible&&t.switchVisible[e.compConf.compId],e.compConf.compId);var n=[];t.refData.forEach((function(e){var a=e.cond,i=e.to.split("$")[1],o=t.data[e.from.split("$")[1]];n.push({operationType:a,bindMapperColumn:i,value:o})}));var i={target:t.target,source:t.source,name:t.name,data:n,sourceData:t.data},o={};o[e.compConf.compId]=Object(a["a"])({},"".concat(t.name),i),e.$store.commit("setLinkage",o),e.updateCompData(!1)}))},linkageConfChanged:function(){var t=this.compConf.linkage;if(t){var e=t.linkEvents,n=t.linkRevEvents;if(e)for(var a=0;a<e.length;a++){var i=e[a];"click"===i.evtType&&i.explosive&&i.def.defTrigger&&"index"===i.def.defType&&(this.activeIndex=i.def.defVal,this.loadLinkage(this.activeIndex))}if(n)for(var o=0;o<n.length;o++){var r=n[o],c=r.evtName.split(":")[1];"click"===c&&this._clickByLinkAge(r)}}}}}},"17f3":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var a={CREATE:"create",RUNNING:"running",REDRAW:"redraw",RELOAD:"reload",DESTROY:"destroy"}},2532:function(t,e,n){"use strict";var a=n("23e7"),i=n("5a34"),o=n("1d80"),r=n("ab13");a({target:"String",proto:!0,forced:!r("includes")},{includes:function(t){return!!~String(o(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"5a34":function(t,e,n){var a=n("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},7031:function(t,e,n){"use strict";var a=n("17f3"),i=n("a553");e["a"]={name:"AbstractComp",mixins:[i["a"]],data:function(){return{chartData:null,nextIndex:0,compDataStatus:"loading",defaultColors:["#04d6ef","#ef58ea","#ff9e87","#0cc2ff","#fad860","#9bca63","#fe8463","#975fe5","#dc81d2","#8d98b3"]}},watch:{compDataStatus:{handler:function(t){"loading"===t&&this.chartLoading()}}},methods:{draw:function(){},chartLoading:function(){this.myChart&&this.myChart.showLoading({text:"",color:"#666",textColor:"#fff",maskColor:"rgba(115, 170, 229, 0)",zlevel:0,fontSize:30,showSpinner:!0,spinnerRadius:10,lineWidth:5})},_toggleCompShow:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;t&&(document.getElementById("".concat(n)).style.transition=e?"all .3s ease-out":"",document.getElementById("".concat(n)).style.transform=e?"scale(1)":"scale(0)")}},created:function(){this.updateState(a["a"].CREATE)},mounted:function(){var t=this;this.updateChartData(this.compData),this.draw(),this.updateState(a["a"].RUNNING),this.$nextTick((function(){t.linkageConfChanged()}))},destroyed:function(){this.updateState(a["a"].DESTROY)},render:function(t){var e=this.compConf.compId;return t("div",{attrs:{id:e},style:{left:"0px",top:"0px",width:"100%",height:"100%",position:"absolute"}})}}},a553:function(t,e,n){"use strict";n("4160"),n("caad"),n("c975"),n("277d"),n("d81d"),n("4e82"),n("b0c0"),n("07ac"),n("ac1f"),n("2532"),n("5319"),n("159b");var a=n("5530"),i=n("17f3"),o=n("2f62"),r=n("0e0b");e["a"]={name:"ComInterface",props:["compConf"],data:function(){return{chartData:null,compDataStatus:"loading"}},computed:Object(a["a"])({compId:function(){return this.compConf.compId},box:function(){return this.compConf.box},styleConf:function(){return this.compConf.style},dataConf:function(){if(this.compConf.data)return this.compConf.data.conf},dataSourceConf:function(){if(this.compConf.data)return this.compConf.data.datasource},compData:function(){return this.$store.state.compData.compData[this.compId]},linkageConf:function(){return this.compConf.linkage},state:function(){return this.compConf.state}},Object(o["c"])({activeCompData:"getCompData"})),watch:{styleConf:{handler:function(t,e){this.updateState(i["a"].REDRAW),this.styleConfChanged(t,e),this.updateState(i["a"].RUNNING)},deep:!0},state:{handler:function(t,e){},deep:!0},compData:{handler:function(t,e){t&&this.updateCompData(!0)},deep:!0},linkageConf:{handler:function(t,e){this.linkageConfChanged(t,e)},deep:!0},"dataSourceConf.type":{handler:function(t,e){this.$evtBus.destroy(this.compId)}}},methods:{convertExpression:function(t){if(-1!==JSON.stringify(t).indexOf("${")){var e=JSON.stringify(t);t=this._getExpressionValue(e),t=JSON.parse(t)}return t},styleConfChanged:function(){},compDataChanged:function(){},resize:function(){},convertChartData:function(t){},linkageConfChanged:function(t,e){},updateState:function(t){this.$emit("compState",t)},updateChartData:function(t){this.chartData=this.convertChartData(t)||t},_linkageDataKeys:function(t){var e=[];for(var n in t)t[n].data.forEach((function(t){e.push({bindMapperColumn:t.bindMapperColumn,value:t.value,operationType:t.operationType})}));return e},_getColumnCondition:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(1===t.useType)return{bindMapperColumn:t.columnName,dsId:e,operationType:t.operationType,value:t.value};if(2===t.useType){if(!n.length)return{};var a=this._getGlobalParamsValue(t.columnName,n);return a?{bindMapperColumn:t.columnName,dsId:e,operationType:t.operationType,value:a}:{}}t.value;var i=this._getExpressionValue(t.value);return i&&-1===i.indexOf("${")&&-1===i.indexOf("}")?{bindMapperColumn:t.columnName,dsId:e,operationType:t.operationType,value:i}:{}},_mergeElementConfig:function(t,e,n){var a=this,i=e.data.conf[t],o=_.cloneDeep(i.searchElementConfigs)||[];if(o.length){var r=n.state.window.globalParams;o.sort((function(t,e){return t.useType-e.useType}));var c={};o.forEach((function(e){var n=a._getColumnCondition(e,t,r);_.isEmpty(n)||(c[e.columnName]=n)})),_.isEmpty(c)||(o=Object.values(c))}var s=n.getters.getLinkagesByCompId(e["compId"]);if(_.isEmpty(s))return o;var u=o.map((function(t){return t.bindMapperColumn}))||[],d=this._linkageDataKeys(s);return d.forEach((function(e,n){var a=u.indexOf(e.bindMapperColumn);-1!==a?(o[n]["value"]=e.value,o[n].operationType=e.operationType):o.push({dsId:t,bindMapperColumn:e.bindMapperColumn,value:e.value,operationType:e.operationType})})),o},_checkRequireFields:function(){var t=this.compConf;if("dataset"===t.data.datasource.type){var e=t.data.conf.datasetSelectedIds;if(e&&Array.isArray(e)&&e.length){var n=t.data.conf.datasetSelectedIds[0],a=t.data.conf[n]["requireFields"];if(!a||!a.length)return!0;var i=this._mergeElementConfig(n,t,this.$store);if(!i.length)return!1;var o=i.map((function(t){return t.bindMapperColumn})),r=0;return a.forEach((function(t){-1!==o.indexOf(t)&&r++})),r===a.length}}return!0},updateCompData:function(t){if(t)this.compDataStatus="loaded",this.updateState(i["a"].RELOAD),this.compData&&(this.updateChartData(this.compData),this.compDataChanged(),this.updateState(i["a"].RUNNING));else if(["dataset"].includes(this.compConf.data.datasource.type)){var e=this._checkRequireFields();if(!e)return;var n=this.$dm._getFormatRequestParams(this.compConf),a=this.$store.getters.getConditionsByCompId(this.compConf.compId);(a.length<1||JSON.stringify(a[0].groupByConfig)!==JSON.stringify(n[0].groupByConfig)||JSON.stringify(a[0].orderByConfigDTO)!==JSON.stringify(n[0].orderByConfigDTO)||JSON.stringify(a[0].searchElementConfigs)!==JSON.stringify(n[0].searchElementConfigs))&&(this.compDataStatus="loading",this.$dm.initCompData(this.compConf))}else this.$dm.initCompData(this.compConf)},_mergeArr:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],a=t.length>e.length?t.length:e.length,i=0;i<a;i++){var o=t[i]?t[i]:e[i];n.push(o)}return n},_showNoDataBox:function(t){var e=document.getElementById("".concat(t)).querySelector("".concat(t,"_no_data_box"));if(!e){var n=document.createElement("div");n.id="".concat(t,"_no_data_box"),n.innerHTML="无数据",document.getElementById("".concat(t)).appendChild(n)}},_handleStaticData:function(){},_handleConditionExpression:function(){},_getCompLinkageParamsValue:function(t,e){var n=this.$store.getters.getLinkagesByCompId(e);if(!n)return null;if(n=n[t[0]],!n)return null;if(n=n["sourceData"],!n)return null;for(var a=1;a<t.length;a++){if(!n[t[a]])return null;n=n[t[a]]}return n},_getGlobalParamsValue:function(t){var e=this.$store.state.window.globalParams;if(!e||!e.length)return null;for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n].value?e[n].value:null;return null},_getExpressionValue:function(t){var e=this,n=r["a"].getCustomExpressionParams(t),a=[];return n&&n.length&&n.forEach((function(t){var n=r["a"].getCustomExpressionCloumn(t);if(n.length>=2)if("global"===n[0]){var i=e._getGlobalParamsValue(n[1]);i?a.push(i):a.push(t)}else{var o=e._getCompLinkageParamsValue(n,e.compConf["compId"]);o?a.push(o):a.push(t)}else a.push(t)})),a.length&&n.forEach((function(e,n){t=t.replace(e,a[n])})),t},_convertEventOutData:function(t,e){if(!e||!e.datasource||"static"===e.datasource.type)return t;var n=e.conf[e.conf.datasetSelectedIds[0]]["datasetMeta"],a=_.cloneDeep(t);if(_.isObject(t)){var i=function(e){n.forEach((function(n){[n.columnDesc,n.columnName].includes(e)&&n.columnDesc&&(a[n.columnDesc]=t[e],a[n.columnName]=t[e])}))};for(var o in t)i(o);return a}return _.isArray(t)?(t.forEach((function(e,i){var o=function(o){n.forEach((function(n){[n.columnDesc,n.columnName].includes(o)&&n.columnDesc&&(a[i][n.columnDesc]=t[e][o],a[i][n.columnName]=t[e][o])}))};for(var r in t[e])o(r)})),a):a}}}},ab13:function(t,e,n){var a=n("b622"),i=a("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(a){}}return!1}}}]);