(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d943028"],{"17f3":function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var a={CREATE:"create",RUNNING:"running",REDRAW:"redraw",RELOAD:"reload",DESTROY:"destroy"}},2532:function(t,n,e){"use strict";var a=e("23e7"),o=e("5a34"),i=e("1d80"),r=e("ab13");a({target:"String",proto:!0,forced:!r("includes")},{includes:function(t){return!!~String(i(this)).indexOf(o(t),arguments.length>1?arguments[1]:void 0)}})},"5a34":function(t,n,e){var a=e("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},7031:function(t,n,e){"use strict";var a=e("17f3"),o=e("a553");n["a"]={name:"AbstractComp",mixins:[o["a"]],data:function(){return{chartData:null,nextIndex:0,compDataStatus:"loading",defaultColors:["#04d6ef","#ef58ea","#ff9e87","#0cc2ff","#fad860","#9bca63","#fe8463","#975fe5","#dc81d2","#8d98b3"]}},watch:{compDataStatus:{handler:function(t){"loading"===t&&this.chartLoading()}}},methods:{draw:function(){},chartLoading:function(){this.myChart&&this.myChart.showLoading({text:"",color:"#666",textColor:"#fff",maskColor:"rgba(115, 170, 229, 0)",zlevel:0,fontSize:30,showSpinner:!0,spinnerRadius:10,lineWidth:5})},_toggleCompShow:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2?arguments[2]:void 0;t&&(document.getElementById("".concat(e)).style.transition=n?"all .3s ease-out":"",document.getElementById("".concat(e)).style.transform=n?"scale(1)":"scale(0)")}},created:function(){this.updateState(a["a"].CREATE)},mounted:function(){var t=this;this.updateChartData(this.compData),this.draw(),this.updateState(a["a"].RUNNING),this.$nextTick((function(){t.linkageConfChanged()}))},destroyed:function(){this.updateState(a["a"].DESTROY)},render:function(t){var n=this.compConf.compId;return t("div",{attrs:{id:n},style:{left:"0px",top:"0px",width:"100%",height:"100%",position:"absolute"}})}}},"857a":function(t,n,e){var a=e("1d80"),o=/"/g;t.exports=function(t,n,e,i){var r=String(a(t)),s="<"+n;return""!==e&&(s+=" "+e+'="'+String(i).replace(o,"&quot;")+'"'),s+">"+r+"</"+n+">"}},9911:function(t,n,e){"use strict";var a=e("23e7"),o=e("857a"),i=e("af03");a({target:"String",proto:!0,forced:i("link")},{link:function(t){return o(this,"a","href",t)}})},a553:function(t,n,e){"use strict";e("4160"),e("caad"),e("c975"),e("277d"),e("d81d"),e("4e82"),e("b0c0"),e("07ac"),e("ac1f"),e("2532"),e("5319"),e("159b");var a=e("5530"),o=e("17f3"),i=e("2f62"),r=e("0e0b");n["a"]={name:"ComInterface",props:["compConf"],data:function(){return{chartData:null,compDataStatus:"loading"}},computed:Object(a["a"])({compId:function(){return this.compConf.compId},box:function(){return this.compConf.box},styleConf:function(){return this.compConf.style},dataConf:function(){if(this.compConf.data)return this.compConf.data.conf},dataSourceConf:function(){if(this.compConf.data)return this.compConf.data.datasource},compData:function(){return this.$store.state.compData.compData[this.compId]},linkageConf:function(){return this.compConf.linkage},state:function(){return this.compConf.state}},Object(i["c"])({activeCompData:"getCompData"})),watch:{styleConf:{handler:function(t,n){this.updateState(o["a"].REDRAW),this.styleConfChanged(t,n),this.updateState(o["a"].RUNNING)},deep:!0},state:{handler:function(t,n){},deep:!0},compData:{handler:function(t,n){t&&this.updateCompData(!0)},deep:!0},linkageConf:{handler:function(t,n){this.linkageConfChanged(t,n)},deep:!0},"dataSourceConf.type":{handler:function(t,n){this.$evtBus.destroy(this.compId)}}},methods:{convertExpression:function(t){if(-1!==JSON.stringify(t).indexOf("${")){var n=JSON.stringify(t);t=this._getExpressionValue(n),t=JSON.parse(t)}return t},styleConfChanged:function(){},compDataChanged:function(){},resize:function(){},convertChartData:function(t){},linkageConfChanged:function(t,n){},updateState:function(t){this.$emit("compState",t)},updateChartData:function(t){this.chartData=this.convertChartData(t)||t},_linkageDataKeys:function(t){var n=[];for(var e in t)t[e].data.forEach((function(t){n.push({bindMapperColumn:t.bindMapperColumn,value:t.value,operationType:t.operationType})}));return n},_getColumnCondition:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(1===t.useType)return{bindMapperColumn:t.columnName,dsId:n,operationType:t.operationType,value:t.value};if(2===t.useType){if(!e.length)return{};var a=this._getGlobalParamsValue(t.columnName,e);return a?{bindMapperColumn:t.columnName,dsId:n,operationType:t.operationType,value:a}:{}}t.value;var o=this._getExpressionValue(t.value);return o&&-1===o.indexOf("${")&&-1===o.indexOf("}")?{bindMapperColumn:t.columnName,dsId:n,operationType:t.operationType,value:o}:{}},_mergeElementConfig:function(t,n,e){var a=this,o=n.data.conf[t],i=_.cloneDeep(o.searchElementConfigs)||[];if(i.length){var r=e.state.window.globalParams;i.sort((function(t,n){return t.useType-n.useType}));var s={};i.forEach((function(n){var e=a._getColumnCondition(n,t,r);_.isEmpty(e)||(s[n.columnName]=e)})),_.isEmpty(s)||(i=Object.values(s))}var c=e.getters.getLinkagesByCompId(n["compId"]);if(_.isEmpty(c))return i;var u=i.map((function(t){return t.bindMapperColumn}))||[],f=this._linkageDataKeys(c);return f.forEach((function(n,e){var a=u.indexOf(n.bindMapperColumn);-1!==a?(i[e]["value"]=n.value,i[e].operationType=n.operationType):i.push({dsId:t,bindMapperColumn:n.bindMapperColumn,value:n.value,operationType:n.operationType})})),i},_checkRequireFields:function(){var t=this.compConf;if("dataset"===t.data.datasource.type){var n=t.data.conf.datasetSelectedIds;if(n&&Array.isArray(n)&&n.length){var e=t.data.conf.datasetSelectedIds[0],a=t.data.conf[e]["requireFields"];if(!a||!a.length)return!0;var o=this._mergeElementConfig(e,t,this.$store);if(!o.length)return!1;var i=o.map((function(t){return t.bindMapperColumn})),r=0;return a.forEach((function(t){-1!==i.indexOf(t)&&r++})),r===a.length}}return!0},updateCompData:function(t){if(t)this.compDataStatus="loaded",this.updateState(o["a"].RELOAD),this.compData&&(this.updateChartData(this.compData),this.compDataChanged(),this.updateState(o["a"].RUNNING));else if(["dataset"].includes(this.compConf.data.datasource.type)){var n=this._checkRequireFields();if(!n)return;var e=this.$dm._getFormatRequestParams(this.compConf),a=this.$store.getters.getConditionsByCompId(this.compConf.compId);(a.length<1||JSON.stringify(a[0].groupByConfig)!==JSON.stringify(e[0].groupByConfig)||JSON.stringify(a[0].orderByConfigDTO)!==JSON.stringify(e[0].orderByConfigDTO)||JSON.stringify(a[0].searchElementConfigs)!==JSON.stringify(e[0].searchElementConfigs))&&(this.compDataStatus="loading",this.$dm.initCompData(this.compConf))}else this.$dm.initCompData(this.compConf)},_mergeArr:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=[],a=t.length>n.length?t.length:n.length,o=0;o<a;o++){var i=t[o]?t[o]:n[o];e.push(i)}return e},_showNoDataBox:function(t){var n=document.getElementById("".concat(t)).querySelector("".concat(t,"_no_data_box"));if(!n){var e=document.createElement("div");e.id="".concat(t,"_no_data_box"),e.innerHTML="无数据",document.getElementById("".concat(t)).appendChild(e)}},_handleStaticData:function(){},_handleConditionExpression:function(){},_getCompLinkageParamsValue:function(t,n){var e=this.$store.getters.getLinkagesByCompId(n);if(!e)return null;if(e=e[t[0]],!e)return null;if(e=e["sourceData"],!e)return null;for(var a=1;a<t.length;a++){if(!e[t[a]])return null;e=e[t[a]]}return e},_getGlobalParamsValue:function(t){var n=this.$store.state.window.globalParams;if(!n||!n.length)return null;for(var e=0;e<n.length;e++)if(n[e].name===t)return n[e].value?n[e].value:null;return null},_getExpressionValue:function(t){var n=this,e=r["a"].getCustomExpressionParams(t),a=[];return e&&e.length&&e.forEach((function(t){var e=r["a"].getCustomExpressionCloumn(t);if(e.length>=2)if("global"===e[0]){var o=n._getGlobalParamsValue(e[1]);o?a.push(o):a.push(t)}else{var i=n._getCompLinkageParamsValue(e,n.compConf["compId"]);i?a.push(i):a.push(t)}else a.push(t)})),a.length&&e.forEach((function(n,e){t=t.replace(n,a[e])})),t},_convertEventOutData:function(t,n){if(!n||!n.datasource||"static"===n.datasource.type)return t;var e=n.conf[n.conf.datasetSelectedIds[0]]["datasetMeta"],a=_.cloneDeep(t);if(_.isObject(t)){var o=function(n){e.forEach((function(e){[e.columnDesc,e.columnName].includes(n)&&e.columnDesc&&(a[e.columnDesc]=t[n],a[e.columnName]=t[n])}))};for(var i in t)o(i);return a}return _.isArray(t)?(t.forEach((function(n,o){var i=function(i){e.forEach((function(e){[e.columnDesc,e.columnName].includes(i)&&e.columnDesc&&(a[o][e.columnDesc]=t[n][i],a[o][e.columnName]=t[n][i])}))};for(var r in t[n])i(r)})),a):a}}}},ab13:function(t,n,e){var a=e("b622"),o=a("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[o]=!1,"/./"[t](n)}catch(a){}}return!1}},af03:function(t,n,e){var a=e("d039");t.exports=function(t){return a((function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}))}},b278:function(t,n,e){},b949:function(t,n,e){"use strict";var a=e("b278"),o=e.n(a);o.a},dfe9:function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"comText",style:t.style},[t.styleConf.showLink?e("a",{style:t.spanstyle,attrs:{href:t.href,target:t.target}},[t._v(t._s(t.text))]):e("span",{style:t.spanstyle,domProps:{innerHTML:t._s(t.text)}})])},o=[],i=(e("c975"),e("0d03"),e("b0c0"),e("d3b7"),e("ac1f"),e("25f0"),e("1276"),e("9911"),e("ade3")),r=e("7031"),s={name:"comText",mixins:[r["a"]],data:function(){return{text:""}},created:function(){var t=this;this.$nextTick((function(){t.text=t.chartData[0].value}))},computed:{spanstyle:function(){return{color:this.styleConf.fontColor}},style:function(){return{paddingTop:this.styleConf.paddingTop+"px",paddingRight:this.styleConf.paddingRight+"px",paddingBottom:this.styleConf.paddingBottom+"px",paddingLeft:this.styleConf.paddingLeft+"px",backgroundColor:this.styleConf.bgColor,backgroundPosition:this.styleConf.bgPosition,backgroundImage:"url(".concat(this.styleConf.bgImage,")"),fontSize:this.styleConf.fontSize+"px",fontFamily:this.styleConf.fontFamily,fontWeight:this.styleConf.fontWeight,width:this.compConf.box.width+"px",height:this.compConf.box.height+"px"}},href:function(){return this.styleConf.showLink?this.styleConf.link:"javascript:void(0)"},target:function(){return this.styleConf.target}},methods:{compDataChanged:function(){this.text=this.chartData[0].value},updateMyChart:function(){var t=_.cloneDeep(this.chartData[0].value);-1!==t.toString().indexOf("${")&&-1!==t.toString().indexOf("}")&&(t=this._getExpressionValue(t)),this.text=t},_clickByLinkAge:function(t){var n=this,e=this;this.$evtBus.on(t,(function(t){var a={sourceData:t.data},o={};o[n.compConf.compId]=Object(i["a"])({},"".concat(t.name),a),e.$store.commit("setLinkage",o),e.updateMyChart()}))},linkageConfChanged:function(){if(this.compConf.linkage&&this.compConf.linkage.linkRevEvents)for(var t=this.compConf.linkage.linkRevEvents,n=0;n<t.length;n++){var e=t[n],a=e.evtName.split(":")[1];"click"===a&&this._clickByLinkAge(e)}}}},c=s,u=(e("b949"),e("2877")),f=Object(u["a"])(c,a,o,!1,null,"6f45ceda",null);n["default"]=f.exports}}]);