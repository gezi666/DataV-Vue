(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25607045"],{"17f3":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var o={CREATE:"create",RUNNING:"running",REDRAW:"redraw",RELOAD:"reload",DESTROY:"destroy"}},2532:function(t,e,n){"use strict";var o=n("23e7"),a=n("5a34"),i=n("1d80"),s=n("ab13");o({target:"String",proto:!0,forced:!s("includes")},{includes:function(t){return!!~String(i(this)).indexOf(a(t),arguments.length>1?arguments[1]:void 0)}})},4084:function(t,e,n){},4785:function(t,e,n){"use strict";var o=n("4084"),a=n.n(o);a.a},"5a34":function(t,e,n){var o=n("44e7");t.exports=function(t){if(o(t))throw TypeError("The method doesn't accept regular expressions");return t}},7031:function(t,e,n){"use strict";var o=n("17f3"),a=n("a553");e["a"]={name:"AbstractComp",mixins:[a["a"]],data:function(){return{chartData:null,nextIndex:0,compDataStatus:"loading",defaultColors:["#04d6ef","#ef58ea","#ff9e87","#0cc2ff","#fad860","#9bca63","#fe8463","#975fe5","#dc81d2","#8d98b3"]}},watch:{compDataStatus:{handler:function(t){"loading"===t&&this.chartLoading()}}},methods:{draw:function(){},chartLoading:function(){this.myChart&&this.myChart.showLoading({text:"",color:"#666",textColor:"#fff",maskColor:"rgba(115, 170, 229, 0)",zlevel:0,fontSize:30,showSpinner:!0,spinnerRadius:10,lineWidth:5})},_toggleCompShow:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;t&&(document.getElementById("".concat(n)).style.transition=e?"all .3s ease-out":"",document.getElementById("".concat(n)).style.transform=e?"scale(1)":"scale(0)")}},created:function(){this.updateState(o["a"].CREATE)},mounted:function(){var t=this;this.updateChartData(this.compData),this.draw(),this.updateState(o["a"].RUNNING),this.$nextTick((function(){t.linkageConfChanged()}))},destroyed:function(){this.updateState(o["a"].DESTROY)},render:function(t){var e=this.compConf.compId;return t("div",{attrs:{id:e},style:{left:"0px",top:"0px",width:"100%",height:"100%",position:"absolute"}})}}},"9bf9":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"table-box",style:t.boxStyle},[n("div",{staticClass:"container",style:t.containerStyle},[t.compConf.style.ranksChange?[n("div",{staticClass:"rank-box"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.compConf.style.showHeader,expression:"compConf.style.showHeader"}],staticClass:"column-box"},[n("table",[n("tbody",[n("tr",{directives:[{name:"show",rawName:"v-show",value:t.compConf.style.showIndex,expression:"compConf.style.showIndex"}]},[n("td",{style:t.headerStyle},[t._v("序号")])]),t._l(t.bodyData,(function(e,o){return n("tr",{key:o},[n("td",{style:t.headerStyle},[t._v(t._s(t.columnDescObject[e[0]]&&t.columnDescObject[e[0]]["columnDesc"]?t.columnDescObject[e[0]]["columnDesc"]:e[0]))])])}))],2)])]),n("div",{staticClass:"data-box",style:t.dataBoxStyle},[n("table",[n("tbody",[n("tr",{directives:[{name:"show",rawName:"v-show",value:t.compConf.style.showIndex,expression:"compConf.style.showIndex"}]},t._l(t.ranksDataLength,(function(e,o){return n("td",{key:o,style:t.listStyle(0)},[t._v(t._s(e))])})),0),t._l(t.bodyData,(function(e,o){return n("tr",{key:o},t._l(e,(function(a,i){return i>0?n("td",{key:i,style:t.listStyle(o),on:{click:function(n){return t._cellClick(e,i)}}},[t._v(t._s(a))]):t._e()})),0)}))],2)])])])]:[n("table",{staticClass:"common-table"},[n("thead",{directives:[{name:"show",rawName:"v-show",value:t.compConf.style.showHeader,expression:"compConf.style.showHeader"}]},[n("tr",[n("td",{directives:[{name:"show",rawName:"v-show",value:t.compConf.style.showIndex,expression:"compConf.style.showIndex"}],style:t.headerStyle},[t._v("序号")]),t._l(t.headerData,(function(e,o){return n("td",{key:o,style:t.headerStyle},[t._v(t._s(t.columnDescObject[e]&&t.columnDescObject[e]["columnDesc"]?t.columnDescObject[e]["columnDesc"]:e))])}))],2)]),n("tbody",t._l(t.bodyData,(function(e,o){return n("tr",{key:o,on:{click:function(n){return t._cellClick(e)}}},[n("td",{directives:[{name:"show",rawName:"v-show",value:t.compConf.style.showIndex,expression:"compConf.style.showIndex"}],style:t.listStyle(o)},[t._v(t._s(o+1))]),t._l(t.headerData,(function(a,i){return n("td",{key:i,style:t.listStyle(o)},[t._v(t._s(e[a]))])}))],2)})),0)])]],2),n("div",{staticClass:"pagation-box",staticStyle:{"text-align":"center","padding-top":"5px"}},[t.compConfStyle.pagation&&t.compConfStyle.pagation.show?n("el-pagination",{attrs:{background:"",small:"",layout:"prev, pager, next","current-page":t.currentPage,total:t.total,"page-size":t.compConfStyle.pagation.pageSize},on:{"current-change":t._oncurrentPageChange}}):t._e()],1)])},a=[],i=(n("99af"),n("4de4"),n("4160"),n("d81d"),n("159b"),n("7031")),s=n("2ef0"),r=n.n(s),c={name:"comp-common-table",created:function(){this._initData()},data:function(){return{headerData:[],bodyData:[],currentPage:1,columnDescObject:{}}},mixins:[i["a"]],computed:{containerStyle:function(){var t=this.compConf.box.height;return this.compConfStyle.pagation&&this.compConfStyle.pagation.show&&(t-=36),{width:this.compConf.box.width+"px",height:t+"px"}},boxStyle:function(){return{width:this.compConf.box.width+"px",height:this.compConf.box.height+"px"}},headerStyle:function(){return{height:this.compConf.style.ranksChange?this.compConf.style.listHeight+"px":this.compConf.style.headerHeight+"px",lineHeight:this.compConf.style.ranksChange?this.compConf.style.listHeight+"px":this.compConf.style.headerHeight+"px",fontSize:this.compConf.style.headerFontSize+"px",color:this.compConf.style.headerFontColor,fontWeight:this.compConf.style.headerFontWeight,backgroundColor:this.compConf.style.headerBgColor,border:this.compConf.style.border.show?"".concat(this.compConf.style.border.width,"px ").concat(this.compConf.style.border.style," ").concat(this.compConf.style.border.color):0,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",padding:"".concat(this.compConf.style.topPadding,"px ").concat(this.compConf.style.rightPadding,"px ").concat(this.compConf.style.bottomPadding,"px ").concat(this.compConf.style.leftPadding,"px")}},paddingLR:function(){return{paddingLeft:this.compConf.style.leftPadding+"px",paddingRight:this.compConf.style.rightPadding+"px",backgroundColor:this.compConf.style.headerBgColor}},dataBoxStyle:function(){var t=this.compConf.showHeader?this.compConf.box.width-80+"px":this.compConf.box.width+"px";return{width:t,overflowY:"auto"}},compConfStyle:function(){return this.compConf.style},total:function(){return"static"===this.dataSourceConf.type?this.compData.length:this.compData[0].length},ranksDataLength:function(){return this.bodyData.length?this.bodyData[0].length-1:0}},methods:{resize:function(){},_cellClick:function(t,e){if(this.compConf.style.ranksChange){var n={};this.bodyData.forEach((function(t){n[t[0]]=t[e]})),t=r.a.cloneDeep(n)}var o={};for(var a in t)o[a]=t[a],this.columnDescObject[a]&&this.columnDescObject[a]["columnDesc"]&&(o[this.columnDescObject[a]["columnDesc"]]=t[a]);this.loadLinkage(o)},loadLinkage:function(t){if(this.compConf.linkage&&this.compConf.linkage.linkEvents)for(var e=this.compConf.linkage.linkEvents,n=0;n<e.length;n++){var o=e[n];if("click"===o.evtType&&o.explosive){var a={data:t};this.$evtBus.emit(o.evtName,a)}}},linkageConfChanged:function(t){if(this.compConf.linkage&&this.compConf.linkage.linkEvents)for(var e=this.compConf.linkage.linkEvents,n=0;n<e.length;n++){var o=e[n];"click"===o.evtType&&o.explosive&&o.def.defTrigger&&"index"===o.def.defType&&this.$store.getters.getPreviewState&&(this.compConf.style.ranksChange?this._cellClick({},o.def.defVal):this._cellClick(this.bodyData[o.def.defVal],0))}},listStyle:function(t){var e=this.compConf.style.bgColor,n=this.compConf.style.fontSize,o=this.compConf.style.fontColor,a=this.compConf.style.bgColors;if(a&&a.length){var i=t%a.length;n=a[i]["fontSize"],o=a[i]["fontColor"],e=a[i]["bgColor"]}return{padding:"".concat(this.compConf.style.topPadding,"px ").concat(this.compConf.style.rightPadding,"px ").concat(this.compConf.style.bottomPadding,"px ").concat(this.compConf.style.leftPadding,"px"),marginBottom:this.compConf.style.marginBottom+"px",height:this.compConf.style.listHeight+"px",lineHeight:this.compConf.style.listHeight+"px",fontSize:n+"px",color:o,backgroundColor:e,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",border:this.compConf.style.border.show?"".concat(this.compConf.style.border.width,"px ").concat(this.compConf.style.border.style," ").concat(this.compConf.style.border.color):0}},_formatColumnDescObj:function(t){var e={};t.forEach((function(t){e[t.columnName]=t})),this.columnDescObject=e},_initData:function(t,e,n){if(t&&t[0]){if(this._formatColumnDescObj(r.a.cloneDeep(n)),this.compConf.style.ranksChange){var o=this._execRanksChange(t,e,n);return this.bodyData=o,void(this.selectColumn=e)}this.bodyData=t,this.headerData=e}},_convertChartData:function(){},updateChartData:function(){var t,e=this,n=(this.dataSourceConf.type,[]),o=[];"static"===this.dataSourceConf.type?(o=r.a.cloneDeep(this.compConf.data.conf.datasetMeta),n=o.map((function(t){return t.columnName})),t=this.compConfStyle.pagation&&this.compConfStyle.pagation.show?this.compData.filter((function(t,n){return n>=(e.currentPage-1)*e.compConfStyle.pagation.pageSize&&n<e.currentPage*e.compConfStyle.pagation.pageSize})):r.a.cloneDeep(this.compData),this._initData(t,n,o)):this.dataConf.datasetSelectedIds&&this.dataConf.datasetSelectedIds[0]&&(this.tableHeaderData=r.a.cloneDeep(this.dataConf[this.dataConf.datasetSelectedIds[0]]["xAxisIds"]),t=this.compConfStyle.pagation&&this.compConfStyle.pagation.show?this.compData[0].filter((function(t,n){return n>=(e.currentPage-1)*e.compConfStyle.pagation.pageSize&&n<e.currentPage*e.compConfStyle.pagation.pageSize})):r.a.cloneDeep(this.compData[0]),this._initData(t,this.dataConf[this.dataConf.datasetSelectedIds[0]]["xAxisIds"],this.dataConf[this.dataConf.datasetSelectedIds[0]]["datasetMeta"]))},_execRanksChange:function(t,e,n){var o={};e.forEach((function(t){return o[t]=[]})),t.forEach((function(t){for(var e in t)o[e].push(t[e])}));var a=[];return e.forEach((function(t,e){a[e]=[t].concat(o[t])})),a},styleConfChanged:function(){this.updateChartData()},_oncurrentPageChange:function(t){this.currentPage=t,this.updateChartData()}},mounted:function(){}},l=c,h=(n("4785"),n("2877")),f=Object(h["a"])(l,o,a,!1,null,"a83ade16",null);e["default"]=f.exports},a553:function(t,e,n){"use strict";n("4160"),n("caad"),n("c975"),n("277d"),n("d81d"),n("4e82"),n("b0c0"),n("07ac"),n("ac1f"),n("2532"),n("5319"),n("159b");var o=n("5530"),a=n("17f3"),i=n("2f62"),s=n("0e0b");e["a"]={name:"ComInterface",props:["compConf"],data:function(){return{chartData:null,compDataStatus:"loading"}},computed:Object(o["a"])({compId:function(){return this.compConf.compId},box:function(){return this.compConf.box},styleConf:function(){return this.compConf.style},dataConf:function(){if(this.compConf.data)return this.compConf.data.conf},dataSourceConf:function(){if(this.compConf.data)return this.compConf.data.datasource},compData:function(){return this.$store.state.compData.compData[this.compId]},linkageConf:function(){return this.compConf.linkage},state:function(){return this.compConf.state}},Object(i["c"])({activeCompData:"getCompData"})),watch:{styleConf:{handler:function(t,e){this.updateState(a["a"].REDRAW),this.styleConfChanged(t,e),this.updateState(a["a"].RUNNING)},deep:!0},state:{handler:function(t,e){},deep:!0},compData:{handler:function(t,e){t&&this.updateCompData(!0)},deep:!0},linkageConf:{handler:function(t,e){this.linkageConfChanged(t,e)},deep:!0},"dataSourceConf.type":{handler:function(t,e){this.$evtBus.destroy(this.compId)}}},methods:{convertExpression:function(t){if(-1!==JSON.stringify(t).indexOf("${")){var e=JSON.stringify(t);t=this._getExpressionValue(e),t=JSON.parse(t)}return t},styleConfChanged:function(){},compDataChanged:function(){},resize:function(){},convertChartData:function(t){},linkageConfChanged:function(t,e){},updateState:function(t){this.$emit("compState",t)},updateChartData:function(t){this.chartData=this.convertChartData(t)||t},_linkageDataKeys:function(t){var e=[];for(var n in t)t[n].data.forEach((function(t){e.push({bindMapperColumn:t.bindMapperColumn,value:t.value,operationType:t.operationType})}));return e},_getColumnCondition:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(1===t.useType)return{bindMapperColumn:t.columnName,dsId:e,operationType:t.operationType,value:t.value};if(2===t.useType){if(!n.length)return{};var o=this._getGlobalParamsValue(t.columnName,n);return o?{bindMapperColumn:t.columnName,dsId:e,operationType:t.operationType,value:o}:{}}t.value;var a=this._getExpressionValue(t.value);return a&&-1===a.indexOf("${")&&-1===a.indexOf("}")?{bindMapperColumn:t.columnName,dsId:e,operationType:t.operationType,value:a}:{}},_mergeElementConfig:function(t,e,n){var o=this,a=e.data.conf[t],i=_.cloneDeep(a.searchElementConfigs)||[];if(i.length){var s=n.state.window.globalParams;i.sort((function(t,e){return t.useType-e.useType}));var r={};i.forEach((function(e){var n=o._getColumnCondition(e,t,s);_.isEmpty(n)||(r[e.columnName]=n)})),_.isEmpty(r)||(i=Object.values(r))}var c=n.getters.getLinkagesByCompId(e["compId"]);if(_.isEmpty(c))return i;var l=i.map((function(t){return t.bindMapperColumn}))||[],h=this._linkageDataKeys(c);return h.forEach((function(e,n){var o=l.indexOf(e.bindMapperColumn);-1!==o?(i[n]["value"]=e.value,i[n].operationType=e.operationType):i.push({dsId:t,bindMapperColumn:e.bindMapperColumn,value:e.value,operationType:e.operationType})})),i},_checkRequireFields:function(){var t=this.compConf;if("dataset"===t.data.datasource.type){var e=t.data.conf.datasetSelectedIds;if(e&&Array.isArray(e)&&e.length){var n=t.data.conf.datasetSelectedIds[0],o=t.data.conf[n]["requireFields"];if(!o||!o.length)return!0;var a=this._mergeElementConfig(n,t,this.$store);if(!a.length)return!1;var i=a.map((function(t){return t.bindMapperColumn})),s=0;return o.forEach((function(t){-1!==i.indexOf(t)&&s++})),s===o.length}}return!0},updateCompData:function(t){if(t)this.compDataStatus="loaded",this.updateState(a["a"].RELOAD),this.compData&&(this.updateChartData(this.compData),this.compDataChanged(),this.updateState(a["a"].RUNNING));else if(["dataset"].includes(this.compConf.data.datasource.type)){var e=this._checkRequireFields();if(!e)return;var n=this.$dm._getFormatRequestParams(this.compConf),o=this.$store.getters.getConditionsByCompId(this.compConf.compId);(o.length<1||JSON.stringify(o[0].groupByConfig)!==JSON.stringify(n[0].groupByConfig)||JSON.stringify(o[0].orderByConfigDTO)!==JSON.stringify(n[0].orderByConfigDTO)||JSON.stringify(o[0].searchElementConfigs)!==JSON.stringify(n[0].searchElementConfigs))&&(this.compDataStatus="loading",this.$dm.initCompData(this.compConf))}else this.$dm.initCompData(this.compConf)},_mergeArr:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],o=t.length>e.length?t.length:e.length,a=0;a<o;a++){var i=t[a]?t[a]:e[a];n.push(i)}return n},_showNoDataBox:function(t){var e=document.getElementById("".concat(t)).querySelector("".concat(t,"_no_data_box"));if(!e){var n=document.createElement("div");n.id="".concat(t,"_no_data_box"),n.innerHTML="无数据",document.getElementById("".concat(t)).appendChild(n)}},_handleStaticData:function(){},_handleConditionExpression:function(){},_getCompLinkageParamsValue:function(t,e){var n=this.$store.getters.getLinkagesByCompId(e);if(!n)return null;if(n=n[t[0]],!n)return null;if(n=n["sourceData"],!n)return null;for(var o=1;o<t.length;o++){if(!n[t[o]])return null;n=n[t[o]]}return n},_getGlobalParamsValue:function(t){var e=this.$store.state.window.globalParams;if(!e||!e.length)return null;for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n].value?e[n].value:null;return null},_getExpressionValue:function(t){var e=this,n=s["a"].getCustomExpressionParams(t),o=[];return n&&n.length&&n.forEach((function(t){var n=s["a"].getCustomExpressionCloumn(t);if(n.length>=2)if("global"===n[0]){var a=e._getGlobalParamsValue(n[1]);a?o.push(a):o.push(t)}else{var i=e._getCompLinkageParamsValue(n,e.compConf["compId"]);i?o.push(i):o.push(t)}else o.push(t)})),o.length&&n.forEach((function(e,n){t=t.replace(e,o[n])})),t},_convertEventOutData:function(t,e){if(!e||!e.datasource||"static"===e.datasource.type)return t;var n=e.conf[e.conf.datasetSelectedIds[0]]["datasetMeta"],o=_.cloneDeep(t);if(_.isObject(t)){var a=function(e){n.forEach((function(n){[n.columnDesc,n.columnName].includes(e)&&n.columnDesc&&(o[n.columnDesc]=t[e],o[n.columnName]=t[e])}))};for(var i in t)a(i);return o}return _.isArray(t)?(t.forEach((function(e,a){var i=function(i){n.forEach((function(n){[n.columnDesc,n.columnName].includes(i)&&n.columnDesc&&(o[a][n.columnDesc]=t[e][i],o[a][n.columnName]=t[e][i])}))};for(var s in t[e])i(s)})),o):o}}}},ab13:function(t,e,n){var o=n("b622"),a=o("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[a]=!1,"/./"[t](e)}catch(o){}}return!1}}}]);